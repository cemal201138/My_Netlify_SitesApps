<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>My Websites</title>

<!-- ‚úÖ FAVICON -->
<link rel="icon" type="image/x-icon" href="favicon.ico">

<style>
:root{
  --bg:#020617;
  --bg-grad:#000;
  --card:rgba(255,255,255,.02);
  --border:#1e293b;
  --text:#e5e7eb;
  --accent:#38bdf8;
  --folder:#fbbf24;
}

.light{
  --bg:#f8fafc;
  --bg-grad:#e5e7eb;
  --card:#ffffff;
  --border:#cbd5f5;
  --text:#020617;
  --accent:#0284c7;
  --folder:#b45309;
}

*{box-sizing:border-box}

body{
  font-family:system-ui;
  background:radial-gradient(circle at top,var(--bg),var(--bg-grad));
  color:var(--text);
  padding:32px;
}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  margin-bottom:20px;
  flex-wrap:wrap;
}

.controls{display:flex;gap:8px}

input,button{
  background:var(--card);
  border:1px solid var(--border);
  color:var(--text);
  padding:8px 12px;
  border-radius:8px;
}

button{cursor:pointer}

#root{max-width:900px}

.tree{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:16px;
}

.folder{
  cursor:pointer;
  font-weight:600;
  color:var(--folder);
  padding:6px;
  border-radius:6px;
}

ul{
  list-style:none;
  padding-left:18px;
  display:none;
}

.file{padding:4px 6px}

.hidden{display:none}

a{
  color:var(--accent);
  text-decoration:none;
}
</style>
</head>

<body>

<header>
  <h1>üìÇ My Websites</h1>
  <div class="controls">
    <input id="search" placeholder="üîç Proje ara...">
    <button id="themeToggle">üåô / ‚òÄÔ∏è</button>
  </div>
</header>

<div id="root">Y√ºkleniyor‚Ä¶</div>

<script>
const API="https://api.github.com/repos/cemal201138/My_Netlify_SitesApps/contents/";

// üåô Tema
if(localStorage.getItem("theme")==="light")
  document.body.classList.add("light");

themeToggle.onclick=()=>{
  document.body.classList.toggle("light");
  localStorage.setItem(
    "theme",
    document.body.classList.contains("light")?"light":"dark"
  );
};

// üî† Normalize
const norm=t=>t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");

async function loadFolder(path){
  const res=await fetch(API+path);
  const items=await res.json();
  const ul=document.createElement("ul");

  for(const i of items){
    const li=document.createElement("li");

    if(i.type==="dir"){
      const f=document.createElement("div");
      f.className="folder";
      f.textContent="üìÅ "+i.name;
      f.dataset.name=norm(i.name);

      const child=await loadFolder(i.path);

      f.onclick=()=>child.style.display=
        child.style.display==="block"?"none":"block";

      li.append(f,child);
      ul.append(li);
    }

    if(i.type==="file" && i.name.endsWith(".html")){
      li.className="file";
      li.dataset.name=norm(i.name);
      li.innerHTML=`üìÑ <a href="${i.path}" target="_blank">${i.name}</a>`;
      ul.append(li);
    }
  }
  return ul;
}

async function init(){
  const res=await fetch(API);
  const items=await res.json();
  const tree=document.createElement("div");
  tree.className="tree";

  for(const i of items){
    if(i.type==="dir"){
      const f=document.createElement("div");
      f.className="folder";
      f.textContent="üìÅ "+i.name;
      f.dataset.name=norm(i.name);

      const c=await loadFolder(i.path);

      f.onclick=()=>c.style.display=
        c.style.display==="block"?"none":"block";

      tree.append(f,c);
    }
  }
  root.innerHTML="";
  root.append(tree);
}
init();

// üîç ARAMA ‚Äì KLAS√ñR A√áMADAN
search.addEventListener("input",()=>{
  const q=norm(search.value);

  document.querySelectorAll(".file,.folder")
    .forEach(e=>e.classList.remove("hidden"));

  if(!q) return;

  document.querySelectorAll(".file").forEach(file=>{
    file.classList.toggle(
      "hidden",
      !file.dataset.name.includes(q)
    );
  });

  document.querySelectorAll(".folder").forEach(f=>{
    const hasVisible=f.nextElementSibling
      ?.querySelector(".file:not(.hidden)");
    f.classList.toggle(
      "hidden",
      !hasVisible && !f.dataset.name.includes(q)
    );
  });
});
</script>

</body>
</html>
